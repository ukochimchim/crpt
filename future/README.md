# Тестовое задание

### Задача
 Реализовать потокобезопасный класс, содержащий метод Future<V> compute(K k, Function<K, V> f),
 который возвращает значение Future<V> по ключу K в соответствии с заданной функцией f, вычисляющей
 значение V по ключу K.
 В случае, если значение K уже встречалось, то значение V не должно вычисляться повторно, а должно    браться из кеша.

### Реализация
 * В качестве потокобезобасного кеша буду использовать ConcurrentHashMap. Данная мапа использует блокировку на уровне узла внутренней корзины.
 * Для получения текущего значения по ключу используется метод computeIfAbsent
   Метод осуществляет поиск значения по ключу, если значение отсутствует, то используется генератор.
   Сокращенная схема работы метода:
   
```
   if (map.get(key) == null) {
    V newValue = mappingFunction.apply(key);
    if (newValue != null)
        map.put(key, newValue);
   }
```

* Для генератора значений ключа используем поток случайных long
* В качестве реализации интерфейса Future используем CompletableFuture и его метод supplyAsync. позволяют нам создавать экземпляр CompletableFuture из функционального типа Supplier.Интерфейс Supplier - это универсальный функциональный интерфейс с единственным методом, который не имеет аргументов и возвращает значение параметризованного типа.Это позволяет предоставить экземпляр Supplier в качестве лямбда-выражения, которое выполняет вычисления и возвращает результат  
* Ожидаем завершения всего набора вычислений значений при помощи CompletableFuture.allOf
* В качестве счетчика вызовов генератора используем потокобезопасный AtomicInteger

### Описание

  Идея проверки заключается в подсчете количества запуска генератора. 

```
Количество вызов генератора = Сумме неповторяющихся элементов + Количество повторяющихся элементов без повторов
```
  
  * Для проверки блокировок конкуретного доступа к элементам ConcurrentHashMap создаем набор повторяющихся ключей.  
  * Считаем сумму повторяющихся элементов
  * Считаем количество неповторяющихся элементов
  * Запускаем генерацию значений map
  * проверяем сумму элементов
  
### Запуск
в директории проекта 

```
mvn clean test  
  
